
SHORT_VERSION_PY = """
# This file was generated by 'versioneer.py' (@VERSIONEER-VERSION@) from
# revision-control system data, or from the parent directory name of an
# unpacked source archive. Distribution tarballs contain a pre-generated copy
# of this file.

import json
import sys
import types

version_json = '''
%s
'''  # END VERSION_JSON


def get_versions(verbose=False):
    return json.loads(version_json)
"""

import sys # --STRIP DURING BUILD
import types # --STRIP DURING BUILD
import json # --STRIP DURING BUILD
import re # --STRIP DURING BUILD

def versions_from_file(filename):
    try:
        with open(filename) as f:
            contents = f.read()
    except EnvironmentError:
        return {}
    mo = re.search(r"version_json = '''\n(.*)'''  # END VERSION_JSON",
                   contents, re.M | re.S)
    if not mo:
        return {}
    return json.loads(mo.group(1))

def write_to_version_file(filename, versions):
    os.unlink(filename)
    contents = json.dumps(versions, sort_keys=True,
                          indent=1, separators=(",", ": "))
    with open(filename, "w") as f:
        f.write(SHORT_VERSION_PY % contents)

    print("set %s to '%s'" % (filename, versions["version"]))

